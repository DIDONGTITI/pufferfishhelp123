---
layout: layouts/article.html
title: "Security audit by Trail of Bits, the new website and v4.2 released"
date: 2022-09-28
permalink: "/blog/20221108-simplex-chat-v4.2-security-audit-new-website.html"
---

# Security audit by Trail of Bits, the new website and v4.2 released

**Published:** Nov 8, 2022

Please note: This is work in progress to reserve permalink, to be published on November 8

## Security audit by Trail of Bits

When we first launched the app in March the common question on Reddit was: "Have you been audited or should we just ignore you?".

We had a growing number of enthusiasts using the app who can accept the security risks of unaudited system, the users who depend on their security were patiently waiting until some independent experts validate our claims.

Trail of Bits, a US based security and technology consultancy whose clients include big tech companies, governmental agencies and major blockchain project, had 2 engineers reviewing SimpleX Chat, specifically simplexmq library that is responsible for all cryptography and networking.

2 medium and 2 low severity issues were identified, all of which would require at least a high difficulty of attack â€“ the attacked would need to have privileged access to the system, may need to know complex technical details, or must discover other weaknesses to exploit them. 3 of these issues are already fixed in v4.2.

We are hugely thankful for Trails Of Bits for the work they did, helping us identify these issues and strengthening the security of SimpleX Chat.

### Medium severity issues

##### X3DH key exchange for double ratchet protocol

I made a mistake in implementing X3DH key exchange - the key derivation function was not applied to the result of concatenation of 3 DH operations. The attack to exploit it has high complexity, as it would require compromising one of private keys generated by the clients, and would only affect forward secrecy until the point where break-in recovery happens (after both sides sent some messages).

Note that SimpleX does not perform X3DH with long-term identity keys, as the SimpleX protocol does not rely on long-term keys to identify client devices. Therefore, the impact of compromising a key will be less severe, as it will affect only the secrets of the current connection.

This issue is fixed in version 4.2 in this PR, and if both clients are updated the key exchange is now secure. Also, previously created connections should be secure as long as both sides sent the messages, but if you believe that your private key(s) could have been compromised (for example, if you started using SimpleX Chat before we added database encryption) I recommend that you create the new connections, at least with your security critical contacts.

##### Keys are stored in unpinned memory and not cleared after their lifetime

The problem here is that the memory with cryptographic keys can be swapped to the storage and potentially accessed by an attacked who has root level access to the device (or the level of access required to access swap file of the application). So, if you are running SimpleX Chat on desktop you could improve its security by running it in isolated container.

On mobile operating systems it is less severe as each application already runs in its own container, and applications do not share access to their swap areas (e.g., on Android swap is a [compressed area in RAM](https://developer.android.com/topic/performance/memory-management) not accessible to other applications).

To exploit this issue an attacker needs to have privileged system access on the device. Also, we believe [Haskell generational garbage collection](https://www.microsoft.com/en-us/research/wp-content/uploads/1993/01/gen-gc-for-haskell.pdf) makes the lifetime of unused memory lower than in other languages.

We will be addressing this issue in the near future, possibly by using library [secure-memory](https://hackage.haskell.org/package/secure-memory-0.0.0.2) created by Kirill Elagin, an engineer at Serokell or some similar approach.

### Low severity issues

#### The functions that do string padding and unpadding can throw exceptions

Both these issues are fixed in 4.2 in this PR, with the additional unit tests, and we also validated that even before the fix the strings that would cause such exception are never passed to this function.

## The new website

TODO

## SimpleX Chat v4.2 released!

TODO

New in this release:

- fixed issues from the security audit!
- group links - group admins can create the links for new members to join
- auto-accept contact requests + configure whether to accept incognito and welcome message
- change group member role
- mark chat as unread

Beta features (enable Developer tools to try them):

- manually switch contact or member to another address / server (it has to be supported by both clients to work)
- receive files faster (enable it in Privacy & Security settings)
